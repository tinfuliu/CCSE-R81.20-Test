
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CCSE 測驗 v16.5.2（內嵌題庫）</title>
<style>
  :root { --bg:#0b1020; --fg:#e7ebff; --card:#141a33; --muted:#99a2d0; --accent:#6aa0ff; }
  body { margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,Noto Sans,'Apple Color Emoji','Segoe UI Emoji'; background:var(--bg); color:var(--fg); }
  header { padding:18px 20px; border-bottom:1px solid #1f2748; position:sticky; top:0; background:linear-gradient(#0b1020,#0b1020cc); backdrop-filter: blur(4px); z-index:10; }
  h1 { font-size:20px; margin:0 0 6px 0; }
  .muted { color: var(--muted); }
  main { max-width: 1100px; margin: 24px auto; padding: 0 16px 40px; }
  .toolbar { display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-bottom:16px; }
  .toolbar > * { background: var(--card); border: 1px solid #1f2748; color: var(--fg); border-radius: 10px; padding:10px 12px; }
  select, input { outline:none; }
  button { cursor:pointer; transition: all .2s ease; }
  button:hover { transform: translateY(-1px); box-shadow: 0 4px 18px rgba(0,0,0,.25); }
  .card { background: var(--card); border:1px solid #1f2748; border-radius: 16px; padding:16px; margin:10px 0 18px; }
  .qhead { display:flex; justify-content:space-between; align-items:baseline; gap:10px; margin-bottom:8px; }
  .qid { font-weight:600; color:#cfd6ff; }
  .qstats { font-size:12px; color:#9ab0ff; }
  .qtxt { font-size:18px; line-height:1.45; white-space:pre-wrap; }
  .choices { display:grid; grid-template-columns:1fr; gap:8px; margin-top:10px; }
  .choice { border:1px solid #2a345f; border-radius:12px; padding:10px; cursor:pointer; }
  .choice.selected { border-color: var(--accent); background: #0d1530; }
  .choice.correct { border-color: #42cd7f; background: #0f2a1a; }
  .choice.wrong { border-color: #ff6b6b; background: #2a1111; }
  .choice.locked { opacity: .7; cursor: not-allowed; }
  .row { display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap; }
  .pill { background:#0f1a3a; border:1px solid #2a345f; border-radius:999px; padding:6px 10px; font-size:12px; color:#cfd6ff; }
  .footer { display:flex; justify-content:space-between; align-items:center; gap:12px; }
  .btn { background: #203162; border:1px solid #40549b; color:white; border-radius:10px; padding:10px 14px; cursor:pointer; }
  .btn.secondary { background: transparent; border-color:#334279; color:#cfd6ff; }
  .btn.review { background:#2a2142; border-color:#7e5bef; }
  .btn.review.active { background:#3b2f6b; border-color:#a58bff; box-shadow: 0 0 0 2px rgba(165,139,255,.25) inset; }
  .btn.disabled { opacity: .5; cursor: not-allowed; }
  .danger { background:#3a1620; border-color:#a33; }
  .scoreBanner { background:#0f1a3a; border:1px solid #2a345f; border-radius:14px; padding:10px 12px; margin:10px 0; font-weight:600; }
  .searchBox { display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
  .searchInput { width:240px; }
  .hidden { display:none; }
  .summary { display:flex; flex-direction:column; gap:6px; }
</style>
</head>
<body>
<header>
  <h1>CCSE 測驗 v16.5.2 <span class="muted">— 內嵌題庫</span></h1>
  <div class="muted" id="hdrMeta"></div>
</header>
<main>
  <section class="card">
    <div class="row">
      <div class="toolbar">
        <label>模式
          <select id="mode">
            <option value="exam">Exam（考試模式）</option>
            <option value="review_list">Review List（複習清單：隨機）</option>
            <option value="review_list_all">Review List（複習清單：全部）</option>
            <option value="search">Search（關鍵字找題）</option>
          </select>
        </label>
        <label id="countWrap">題數
          <select id="count">
            <option>5</option>
            <option>10</option>
            <option selected>20</option>
            <option>50</option>
            <option>100</option>
          </select>
        </label>
        <label id="rangeWrap">題號範圍
          <input id="rangeFrom" type="number" min="1" placeholder="起(如50)" style="width:90px" />
          <span>—</span>
          <input id="rangeTo" type="number" min="1" placeholder="迄(如100)" style="width:90px" />
        </label>
        <div class="searchBox" id="searchWrap">
          <input id="searchInput" class="searchInput" type="text" placeholder="關鍵字（多字詞以空白分隔）">
          <button class="btn secondary" id="searchBtn">搜尋</button>
          <button class="btn secondary" id="clearSearchBtn">清除</button>
        </div>
        <label><input type="checkbox" id="toggleOriginal"> 顯示原始題號</label>
        <button class="btn" id="startBtn">開始</button>
        <button class="btn secondary" id="resetBtn">重置複習清單/統計</button>
      </div>
      <div class="row">
        <div class="scoreBanner hidden" id="scoreBanner"></div>
      </div>
    </div>
  </section>

  <div id="quiz"></div>

  <section class="card hidden" id="footerCard">
    <div class="footer">
      <div>
        <button class="btn" id="prevBtn">上一題（←）</button>
        <button class="btn" id="confirmBtn">確認（Enter）</button>
        <button class="btn" id="nextBtn">下一題（→）</button>
        <button class="btn review" id="toggleReviewBtn">加入/移出複習清單（5）</button>
      </div>
      <div>
        <button class="btn" id="submitBtn">交卷（列出本次全部題）</button>
        <button class="btn secondary" id="exportReviewBtn">匯出複習清單ID</button>
      </div>
    </div>
  </section>
</main>
<script>
const BANK = [{"id": 1, "question": "Choose the correct syntax to add a new host named “emailserver1” with IP address 10.50.23.90 using GAiA Management CLI?", "choices": ["mgmt_cli add host name “emailserver1” ip-address 10.50.23.90", "mgmt_cli add host “emailserver1” address 10.50.23.90", "mgmt_cli add host name “myHost12 ip” address 10.50.23.90", "mgmt_cli add host name ip-address 10.50.23.90"], "answer": 0}, {"id": 2, "question": "Which method below is NOT one of the ways to communicate using the Management API’s?", "choices": ["Typing API commands using Gaia’s secure shell (clish)", "Typing API commands from a dialog box inside the SmartConsole GUI application", "Sending API commands over an http connection using web-services", "Typing API commands using the “mgmt_cli” command"], "answer": 2}, {"id": 3, "question": "Which of the following is NOT a type of Check Point API available in R80.x?", "choices": ["Identity Awareness Web Services", "OPSEC SDK", "Management", "Mobile Access"], "answer": 3}, {"id": 4, "question": "What API command below creates a new host object with the name “My Host” and IP address of “192.168.0.10”?", "choices": ["set host name “My Host” ip-address “192.168.0.10”", "create host name “My Host” ip-address “192.168.0.10”", "new host name “My Host” ip-address “192.168.0.10”", "mgmt_cli –m <mgmt ip> add host name “My Host” ip-address “192.168.0.10”"], "answer": 3}, {"id": 5, "question": "What command verifies that the API server is responding?", "choices": ["api stat", "show api_status", "api_get_status", "api status"], "answer": 3}, {"id": 6, "question": "What are the different command sources that allow you to communicate with the API server?", "choices": ["API_cli Tool, Gaia CLI, Web Services", "SmartConsole GUI Console, API_cli Tool, Gaia CLI, Web Services", "SmartView Monitor, API_cli Tool, Gaia CLI, Web Services", "SmartConsole GUI Console, mgmt_cli Tool, Gaia CLI, Web Services"], "answer": 3}, {"id": 7, "question": "Alice works for a big security outsourcing provider company and as she receives a lot of change requests per day she wants to use for scripting daily tasks the API services from Check Point for the Management API. Firstly, she needs to be aware if the API services are running for the management. Which of the following Check Point Command is true:", "choices": ["status mgmt api", "api mgmt status.", "status api", "api status"], "answer": 3}, {"id": 8, "question": "What is correct statement about Security Gateway and Security Management Server failover in Check Point R81.X in terms of Check Point Redundancy driven solutions?", "choices": ["Security Gateway failover as well as Security Management Server failover is an automatic procedure.", "Security Gateway failover is an automatic procedure but Security Management Server failover is a manual procedure.", "Security Gateway failover is a manual procedure but Security Management Server failover is an automatic procedure.", "Security Gateway failover as well as Security Management Server failover is a manual procedure."], "answer": 1}, {"id": 9, "question": "What is the most ideal Synchronization Status for Security Management Server High Availability deployment?", "choices": ["Never been synchronized", "Collision", "Synchronized", "Lagging"], "answer": 2}, {"id": 10, "question": "What state is the Management HA in when both members have different policies/databases?", "choices": ["Lagging", "Never been synchronized", "Collision", "Synchronized"], "answer": 2}, {"id": 11, "question": "You are asked to check the status of several user-mode processes on the management server and gateway. Which of the following processes can only be seen on a Management Server?", "choices": ["cpd", "fwd", "cpwd", "fwm"], "answer": 3}, {"id": 12, "question": "What is the command used to activate Multi-Version Cluster mode?", "choices": ["set mvc on in Clish", "set cluster member mvc on in Clish", "set cluster mvc on in Expert Mode", "set cluster MVC on in Expert Mode"], "answer": 1}, {"id": 13, "question": "How many versions, besides the destination version, are supported in a Multi-Version Cluster Upgrade?", "choices": ["4", "3", "2", "1"], "answer": 3}, {"id": 14, "question": "Which upgrade method you should use upgrading from R80.40 to R81.20 to avoid any downtime?", "choices": ["Multi-Version Cluster Upgrade (MVC)", "Zero Downtime Upgrade (ZDU)", "Connectivity Upgrade (CU)", "Minimal Effort Upgrade (ME)"], "answer": 0}, {"id": 15, "question": "What are the main stages of a policy installation?", "choices": ["Initiation, Conversion and Save", "Initiation, Conversion and FWD REXEC", "Verification, Commit, Installation", "Verification, Compilation, Transfer and Commit"], "answer": 3}, {"id": 16, "question": "What are valid Policy Types in R81.X?", "choices": ["Access Control, Threat Prevention, QoS, Desktop Security", "Access Control, IPS, Threat Emulation, NAT", "Access Control, IPS, QoS, DLP", "Access Control, RemoteAccess VPN, NAT, IPS"], "answer": 0}, {"id": 17, "question": "After some changes in the firewall policy, you run into some issues. You want to test if the policy from two weeks ago has the same issue. You don't want to lose the changes from the last weeks. What is the best way to do it?", "choices": ["In SmartConsole under Security Policies go to the Installation History view of the Gateway, select the policy version from two weeks ago and press the ‘Install specific version’ button", "Use the Gaia WebUI to take a backup of the Gateway. In SmartConsole under Security Policies go to the Installation History view of the Gateway, select the policy version from two weeks ago and press the ‘Install specific version’ button", "In SmartConsole under Manage & Settings go to Sessions –> Revisions and select the revision from two weeks ago. Run the action ‘Revert to this revision...’.", "Use the Gaia WebUI to take a snapshot of management. In the In SmartConsole under Manage & Settings go to Sessions -> Revisions and select the revision from two weeks ago. Run the action ‘Revert to this revision...’ Restore the management snapshot."], "answer": 0}, {"id": 18, "question": "Which Check Point process provides logging services, such as forwarding logs from Gateway to Log Server, providing Log Export API (LEA) & Event Logging API (ELA) services.", "choices": ["DASSERVICE", "FWD", "CPVIEWD", "CPD"], "answer": 1}, {"id": 19, "question": "The back-end database for Check Point Management uses:", "choices": ["PostgreSQL", "MongoDB", "MySQL", "DBMS"], "answer": 0}, {"id": 20, "question": "Where can you see and search records of action done by R80 SmartConsole administrators?", "choices": ["In SmartAudit Log View", "In Smartlog, all logs", "In the Logs & Monitor, logs, select “Audit Log View”", "In SmartView Tracker, open active log"], "answer": 2}, {"id": 21, "question": "Identity Awareness allows the Security Administrator to configure network access based on which of the following?", "choices": ["Name of the application, identity of the user, and identity of the machine", "Identity of the machine, username, and certificate", "Browser-Based Authentication, identity of a user, and network location", "Network location, identity of a user, and identity of a machine"], "answer": 3}, {"id": 22, "question": "While enabling the Identity Awareness blade the Identity Awareness wizard does not automatically detect the windows domain. Why does it not detect the windows domain?", "choices": ["Security Gateway is not part of the Domain", "SmartConsole machine is not part of the domain", "Identity Awareness is not enabled on Global properties", "Security Management Server is not part of the domain"], "answer": 1}, {"id": 23, "question": "Which of the following is NOT a method used by Identity Awareness for acquiring identity?", "choices": ["Remote Access", "Active Directory Query", "Cloud IdP (Identity Provider)", "RADIUS"], "answer": 2}, {"id": 24, "question": "Identity Awareness lets an administrator easily configure network access and auditing based on three times. Choose the correct statement.", "choices": ["Network location, the identity of a user and the identity of a machine.", "Geographical location, the identity of a user and the identity of a machine.", "Network location, the identity of a user and the active directory membership.", "Network location, the telephone number of a user and the UID of a machine."], "answer": 0}, {"id": 25, "question": "Fill in the blanks. Default port numbers for an LDAP server is _______ for standard connections and _______ SSL connections.", "choices": ["443; 389", "636; 8080", "290; 3389", "389; 636"], "answer": 3}, {"id": 26, "question": "By default, what information is NOT collected from a Security Gateway in a CPINFO?", "choices": ["OS and Network Statistics", "Configuration and database files", "Firewall logs", "System message logs"], "answer": 2}, {"id": 27, "question": "What command can you use to have cpinfo display all installed hotfixes?", "choices": ["cpinfo-hf", "cpinfo installed_jumbo", "cpinfo –get hf", "cpinfo –y all"], "answer": 3}, {"id": 28, "question": "Which command collects diagnostic data for analyzing a customer setup remotely?", "choices": ["cpv", "cpinfo", "migrate export", "sysinfo"], "answer": 1}, {"id": 29, "question": "By default, what type of rules in the Access Control rulebase allow the control connections?", "choices": ["Implicit Rules", "Explicitly Implied Rules", "Implied Rules", "Explicit Rules"], "answer": 2}, {"id": 30, "question": "Check Point Support in many cases asks you for a configuration summary of your Check Point system. This is also called:", "choices": ["sysinfo", "cpsizeme", "cpinfo", "cpexport"], "answer": 2}, {"id": 31, "question": "What is the name of the secure application for Mail/Calendar for mobile devices?", "choices": ["Secure Workspace", "Capsule Mail", "Capsule Workspace", "Capsule VPN"], "answer": 2}, {"id": 32, "question": "What is the difference between SSL VPN and IPSec VPN?", "choices": ["SSL VPN requires installation of a resilient VPN client", "SSL VPN and IPSec VPN are the same", "IPSec VPN does not require installation of a resident VPN client", "IPSec VPN requires installation of a resident VPN client and SSL VPN requires only an installed Browser"], "answer": 3}, {"id": 33, "question": "Which Remote Access Client does not provide an Office-Mode Address?", "choices": ["Endpoint Security Suite", "Check Point Mobile", "SecuRemote", "Endpoint Security VPN"], "answer": 2}, {"id": 34, "question": "Which feature allows Remote-access VPN users to access resources across a site-to-site VPN tunnel?", "choices": ["Mobile Access VPN Domain", "Community Specific VPN Domain", "Remote Access VPN Switch", "Network Access VPN Domain"], "answer": 1}, {"id": 35, "question": "SSL Network Extender (SNX) is a thin SSL VPN on-demand client that is installed on the remote user’s machine via the web browser. What are the two modes of SNX?", "choices": ["Network and Layers", "Application and Client Service", "Network and Application", "Virtual Adapter and Mobile App"], "answer": 2}, {"id": 36, "question": "Which one of the following is true about Capsule Connect?", "choices": ["It is a full layer 3 VPN client", "It is supported only on iOS phones and Windows PCs", "It offers full enterprise mobility management", "It does not support all VPN authentication methods"], "answer": 0}, {"id": 37, "question": "Which Mobile Access Application allows a secure container on Mobile devices to give users access to internal website, file share and emails?", "choices": ["Check Point Capsule Workspace", "Check Point Capsule Remote", "Check Point Mobile Web Portal", "Check Point Remote User"], "answer": 0}, {"id": 38, "question": "Which Mobile Access Solution is clientless?", "choices": ["Mobile Access Portal", "Checkpoint Mobile", "Endpoint Security Suite", "SecuRemote"], "answer": 0}, {"id": 39, "question": "The Log server sends what to the Correlation Unit?", "choices": ["Authentication requests", "Event Policy", "Logs", "CPMI dbsync"], "answer": 2}, {"id": 40, "question": "What is the recommended configuration when the customer requires SmartLog indexing for 14 days and SmartEvent to keep events for 180 days?", "choices": ["Choose different setting for log storage and SmartEvent db", "It is not possible", "Install Management and SmartEvent on different machines", "Use Multi-Domain Management Server"], "answer": 0}, {"id": 41, "question": "What are the two types of tests when using the Compliance blade?", "choices": ["Tests conducted based on the IoC XML file and analysis of SOLR documents", "Access Control policy analysis and Threat Prevention policy analysis", "Policy-based tests and Global properties", "Global tests and Object-based tests"], "answer": 3}, {"id": 42, "question": "Which of the following statements about SecureXL NAT Templates is true?", "choices": ["NAT Templates are generated to achieve high session rate for NAT. These templates store the NAT attributes of connections matched by rulebase so that similar new connections can take advantage of this information and do NAT without the expensive rulebase lookup. These are disabled by default and work only if Accept Templates are disabled.", "NAT Templates are generated to achieve high session rate for NAT. These templates store the NAT attributes of connections matched by rulebase so that similar new connections can take advantage of this information and do NAT without the expensive rulebase lookup. These are enabled by default and work only if Accept Templates are enabled.", "ACCEPT Templates are generated to achieve high session rate for NAT. These templates store the NAT attributes of connections matched by rulebase so that similar new connections can take advantage of this information and do NAT without the expensive rulebase lookup. These are disabled by default and work only if NAT Templates are disabled.", "DROP Templates are generated to achieve high session rate for NAT. These templates store the NAT attributes of connections matched by rulebase so that similar new connections can take advantage of this information and do NAT without the expensive rulebase lookup. These are disabled by default and work only if NAT Templates are disabled."], "answer": 1}, {"id": 43, "question": "In what way is Secure Network Distributor (SND) a relevant feature of the Security Gateway?", "choices": ["SND is used to distribute packets among Firewall instances", "SND is a feature to accelerate multiple SSL VPN connections", "SND is a feature of fw monitor to capture accelerated packets", "SND is an alternative to IPSec Main Mode, using only 3 packets."], "answer": 0}, {"id": 44, "question": "Which statement is most correct regarding about “CoreXL Dynamic Dispatcher’?", "choices": ["The CoreXL FW instances assignment mechanism is based on IP Protocol type.", "The CoreXL FW instances assignment mechanism is based on the utilization of CPU cores", "The CoreXL FW instances assignment mechanism is based on Source MAC addresses, Destination MAC addresses", "The CoreXL FW instances assignment mechanism is based on Source IP addresses, Destination IP addresses, and the IP ‘Protocol’ type."], "answer": 1}, {"id": 45, "question": "What kind of information would you expect to see when using the “sim affinity –I” command?", "choices": ["Overview over SecureXL templated connections", "The VMACs used in a Security Gateway cluster", "Affinity Distribution", "The involved firewall kernel modules in inbound and outbound packet chain"], "answer": 2}, {"id": 46, "question": "CoreXL is NOT supported when one of the following features is enabled:", "choices": ["Overlapping NAT", "Route-based VPN", "IPv6", "IPS"], "answer": 0}, {"id": 47, "question": "What are the three SecureXL Templates available in R81.10?", "choices": ["Accept Templates, Drop Templates, NAT Templates", "PEP Templates, QoS Templates, VPN Templates", "Accept Templates, PDP Templates, PEP Templates", "Accept Templates, Drop Templates, Reject Templates"], "answer": 0}, {"id": 48, "question": "What is the correct description for the Dynamic Balancing / Split feature?", "choices": ["Dynamic Balancing / Split dynamically change the number of SND's and firewall instances based on the current load. It is only available on Quantum Appliances (not on Quantum Spark or Open Server)", "Dynamic Balancing / Split dynamically distribute the traffic from one network interface to multiple SND’s. The interface must support Multi- Queue. It is only available on Quantum Appliances (not on Quantum Spark or Open Server)", "Dynamic Balancing / Split dynamically change the number of SND’s and firewall instances based on the current load. It is only available on Quantum Appliances and Open Server (not on Quantum Spark)", "Dynamic Balancing / Split dynamically distribute the traffic from one network interface to multiple SND’s. The interface must support Multi- Queue. It is only available on Quantum Appliances and Open Server (not on Quantum Spark)"], "answer": 0}, {"id": 49, "question": "Which statement is WRONG regarding the usage of the Central Deployment in SmartConsole?", "choices": ["Only Hotfixes can be installed with the Central Deployment in SmartConsole", "You can install Hotfixes with the Central Deployment in SmartConsole", "You can upgrade your cluster without user intervention with the Central Deployment in SmartConsole from R80.40 to R81.20.", "You can install Jumbo Hotfix accumulators with the Central Deployment in SmartConsole."], "answer": 0}, {"id": 50, "question": "What is false regarding prerequisites for the Central Deployment usage?", "choices": ["The Security Gateway must have a policy installed", "The administrator must have write permission on SmartUpdate", "No need to establish SIC between gateways and the management server, since the CDT tool will take care about SIC automatically", "Security Gateway must have the latest CPUSE Deployment Agent"], "answer": 2}, {"id": 51, "question": "The installation of a package via SmartConsole CANNOT be applied on", "choices": ["A single Security Gateway", "A full Security Cluster (All Cluster Members included)", "Multiple Security Gateways and/or Clusters", "R81.20 Security Management Server"], "answer": 3}, {"id": 52, "question": "What is the purpose of the command “ps aux | grep fwd”?", "choices": ["You can check whether the IPS default setting is set to Detect or Prevent mode", "You can check the Process ID and the processing time of the fwd process.", "You can convert the log file into Post Script format.", "You can list all Process IDs for all running services."], "answer": 1}, {"id": 53, "question": "Which of these statements describes the Check Point ThreatCloud?", "choices": ["Blocks or limits usage of web applications", "Prevents or controls access to web sites based on category", "A worldwide collaborative security network", "Prevents Cloud vulnerability exploits"], "answer": 2}, {"id": 54, "question": "Using Web Services to access the API, which Header Name/Value had to be in the HTTP Post request after the login?", "choices": ["uuid Universally Unique Identifier", "API-Key", "user-uid", "X-chkp-sid Session Unique Identifier"], "answer": 3}, {"id": 55, "question": "What command would show the API server status?", "choices": ["api status", "show api status", "cpm status", "api restart"], "answer": 0}, {"id": 56, "question": "What could NOT be a reason for synchronization issues in a Management HA environment? server.", "choices": ["Hardware clocks do not match even with adjustments for different time zones", "Accidentally, you have configured unique IP addresses per Management Server which invalidates the CA Certificate", "There is a network connectivity failure between the servers", "The products installed on the servers do not match: one device is a Standalone Server while the other is only a Security Management"], "answer": 1}, {"id": 57, "question": "What order should be used when upgrading a Management High Availability Cluster?", "choices": ["Secondary Management, then Primary Management", "Active Management, then Standby Management", "Standby Management, then Active Management", "Primary Management, then Secondary Management"], "answer": 3}, {"id": 58, "question": "You need to see which hotfixes are installed on your Check Point server, which command would you use?", "choices": ["cpinfo –h all", "cpinfo –o hotfix", "cpinfo –y all", "cpinfo –I hotfix"], "answer": 2}, {"id": 59, "question": "What mechanism can ensure that the Security Gateway can communicate with the Management Server with ease in situations with overwhelmed network resources?", "choices": ["There is a feature for ensuring stable connectivity to the management server and is done via Priority Queuing.", "The corresponding feature is new to R81.10 and is called “Management Data Plane Separation”", "The corresponding feature is called “Dynamic Split”", "The corresponding feature is called “Dynamic Dispatching”"], "answer": 1}, {"id": 60, "question": "Which process is used mainly for backward compatibility of gateways in R80.x and newer? It provides communication with GUI-client, database manipulation, policy compilation and Management HA synchronization.", "choices": ["cpm", "fwd", "cpd", "fwm"], "answer": 3}, {"id": 61, "question": "What component of Management is used for indexing?", "choices": ["fwm", "SOLR", "API Server", "DBSync"], "answer": 1}, {"id": 62, "question": "What is the responsibility of SOLR process on the management server?", "choices": ["Validating all data before it’s written into the database", "It generates indexes of data written to the database", "Communication between SmartConsole applications and the Security Management Server", "Writing all information into the database"], "answer": 1}, {"id": 63, "question": "What is the difference between Updatable Objects and Dynamic Objects", "choices": ["Updatable Objects is a Threat Cloud Service. The provided Objects are updated automatically. Dynamic Objects are created and maintained locally. In both cases there is no need to install policy for the changes to take effect.", "Dynamic Objects are maintained automatically by the Threat Cloud. For Dynamic Objects there is no need to install policy for the changes to take effect. Updatable Objects are created and maintained locally.", "Updatable Objects is a Threat Cloud Service. The provided Objects are updated automatically. Dynamic Objects are created and maintained locally. For Dynamic Objects there is no need to install policy for the changes to take effect.", "Dynamic Objects are maintained automatically by the Threat Cloud. Updatable Objects are created and maintained locally. In both cases there is no need to install policy for the changes to take effect."], "answer": 0}, {"id": 64, "question": "Which process handles connections from SmartConsole R80?", "choices": ["cpm", "cpd", "cpmd", "fwd"], "answer": 0}, {"id": 65, "question": "Identity Awareness allows easy configuration for network access and auditing based on what three items?", "choices": ["Client machine IP address.", "Network location, the identity of a user and the identity of a machine", "Log server IP address.", "Gateway proxy IP address."], "answer": 1}, {"id": 66, "question": "Which of the following cannot be configured in an Access Role Object?", "choices": ["Networks", "Machines", "Users", "Time"], "answer": 3}, {"id": 67, "question": "Fill in the blank: RADIUS protocol uses ______ to communicate with the gateway.", "choices": ["TDP", "CCP", "HTTP", "UDP"], "answer": 3}, {"id": 68, "question": "Which of the following is NOT a component of a Distinguished Name?", "choices": ["Common Name", "Country", "User container", "Organizational Unit"], "answer": 2}, {"id": 69, "question": "Using Threat Emulation technologies, what is the best way to block .exe and .bat file types?", "choices": ["Enable .exe bat protection in IPS Policy", "tecli advanced attributes set prohibited_file_types exe, bat", "create FW rule for particular protocol", "enable DLP and select .exe and .bat file type"], "answer": 1}, {"id": 70, "question": "A user complains that some Internet resources are not available. The Administrator is having issues seeing if packets are being dropped at the firewall (not seeing drops in logs). What is the solution to troubleshoot the issue?", "choices": ["run “fw ctl zdebug drop” on the relevant gateway", "run “cpstop” on the relevant gateway and check the ping again", "run “fw unloadlocal” on the relevant gateway and check the ping again", "run “fw log” on the relevant gateway"], "answer": 0}, {"id": 71, "question": "Which command will reset the kernel debug options to default settings?", "choices": ["fw ctl dbg –a 0", "fw ctl debug set 0", "fw ctl debug 0", "fw ctl dbg resetall"], "answer": 2}, {"id": 72, "question": "Which Operating Systems are supported for the Endpoint Security VPN?", "choices": ["Windows and Red Hat Linux", "Windows and SPARC Solaris", "Windows and x86 Solaris", "Windows and macOS computers"], "answer": 3}, {"id": 73, "question": "Alice knows about the Check Point Management HA installation from Bob and needs to know which Check Point Security Management Server is currently capable of issuing and managing certificate. Alice uses the Check Point command “cpconfig” to run the Check Point Security Management Server configuration tool on both Check Point Management HA instances “Primary & Secondary”. Which configuration option does she need to look for?", "choices": ["Certicate's Fingerprint", "Random Pool", "Certificate Authority", "CA Authority"], "answer": 2}, {"id": 74, "question": "Is it possible to establish a VPN before the user login to the Endpoint Client.", "choices": ["Yes, you had to set neo_remember_user_password to true in the traffic.defaults of the Remote Access Client or you can use the endpoint_vpn_remember_user_password attribute in the trac_client_1.ttm file located in the $FWDIR/conf directory on the Security Gateway", "Yes, you had to set neo_always_connected to true in the traffic.defaults of the Remote Access Client or you can use the endpoint_vpn_always_connected attribute in the trac_client_1.ttm file located in the $FWDIR/conf directory on the Security Gateway", "No, the user must login first.", "Yes, you have to enable Machine Authentication in the Gateway object of the Smart Console"], "answer": 3}, {"id": 75, "question": "Mobile Access Gateway can be configured as a reverse proxy for Internal Web Applications. Reverse proxy users browse to a URL that is resolved to the Security Gateway IP address. Which of the following Check Point command is true for enabling the Reverse Proxy:", "choices": ["ReverseProxy", "ReverseCLIProxy", "ReverseProxyCLI", "ProxyReverseCLI"], "answer": 2}, {"id": 76, "question": "Capsule Connect and Capsule Workspace both offer secured connection for remote users who are using their mobile devices. However, there are differences between the two. Which of the following statements correctly identify each product’s capabilities? and MDM cooperative enforcement.", "choices": ["For compliance/host checking, Workspace offers the MDM cooperative enforcement, whereas Connect offers both jailbreak/root detection", "Workspace can support any application, whereas Connect has a limited number of application types which it will support", "Workspace supports iOS, Android, and WP8, whereas Connect supports iOS and Android only", "For credential protection, Connect uses One-time Password login support, but has no SSO support, whereas Workspace offers both One-Time Password login support as well as SSO for specific applications."], "answer": 3}, {"id": 77, "question": "What are the two modes for SNX (SSL Network Extender)?", "choices": ["Network Mode and Hub Mode", "Network Mode and Application Mode", "Visitor Mode and Office Mode", "Office Mode and Hub Mode"], "answer": 1}, {"id": 78, "question": "Native Applications require a thin client under which circumstances?", "choices": ["If you want to have assigned a particular Office Mode IP address", "If you are about to use a client (FTP, RDP, ...) that is installed on the endpoint.", "If you want to use a VPN Client that is not officially supported by the underlying operating system", "If you want to use a legacy 32-Bit Windows OS"], "answer": 1}, {"id": 79, "question": "In SmartConsole, where do you manage your Mobile Access Policy?", "choices": ["Through the Mobile Console", "Shared Gateways Policy", "From the Dedicated Mobility Tab", "Smart Dashboard"], "answer": 3}, {"id": 80, "question": "You have used the SmartEvent GUI to create a custom Event policy. What is the best way to display the correlated Events generated by SmartEvent Policies?", "choices": ["In the SmartConsole / Logs & Monitor –> open the Logs View and use type:Correlated as query filter.", "Select the Events tab in the SmartEvent GUI or use the Events tab in the SmartView web interface.", "Open SmartView Monitor and select the SmartEvent Window from the main menu.", "In the SmartConsole / Logs & Monitor –> open a new Tab and select External Apps / SmartEvent."], "answer": 0}, {"id": 81, "question": "When detected, an event can activate an Automatic Reaction. The SmartEvent administrator can create and configure one Automatic Reaction, or many, according to the needs of the system. Which of the following statement is false and NOT part of possible automatic reactions:", "choices": ["Syslog", "SNMP Trap", "Mail", "Block Source"], "answer": 0}, {"id": 82, "question": "What are possible Automatic Reactions in SmartEvent?", "choices": ["Web Mail, Forward to SandBlast Appliance, SNMP Trap, External Script", "Web Mail, Block Service, SNMP Trap, SmartTask, Geo Protection", "Web Mail, Block Destination, SNMP Trap, SmartTask", "Mail, SNMP Trap, Block Source, Block Event Activity, External Script"], "answer": 3}, {"id": 83, "question": "Which command can you use to enable or disable multi-queue per interface?", "choices": ["Cpmqueue set", "Set cpmq enable", "Cpmq cong", "cpmq set"], "answer": 3}, {"id": 84, "question": "What is Dynamic Balancing? maximizing the session rate.", "choices": ["It is a feature that uses a daemon to balance the required number of firewall instances and SNDs based on the current load", "It is a ClusterXL feature that switches an HA cluster into an LS cluster if required to maximize throughput.", "It is a CoreXL feature that assigns the SND to network interfaces to balance the RX Cache of the interfaces", "It is a new feature that is capable of dynamically reserve the amount of Hash kernel memory to reflect the resource usage necessary for"], "answer": 0}, {"id": 85, "question": "Which is the command to identify the NIC driver before considering about the employment of the Multi-Queue feature?", "choices": ["ip show int eth0", "show interface eth0 mq", "ifcong –i eth0 verbose", "ethtool –i eth0"], "answer": 3}, {"id": 86, "question": "What is the minimum number of CPU cores required to enable CoreXL?", "choices": ["2", "1", "4", "6"], "answer": 0}, {"id": 87, "question": "What does Backward Compatibility mean upgrading the Management Server and how can you check it?", "choices": ["The Management Server is able to manage older Gateways. The lowest supported version in the Installation and Upgrade Guide", "The Management Server is able to manage older Gateways. The lowest supported version is documented in the Release Notes", "You will be able to connect to older Management Server with the SmartConsole. The lowest supported version is documented in the Release Notes", "You will be able to connect to older Management Server with the SmartConsole. The lowest supported version is documented in the Installation and Upgrade Guide"], "answer": 1}, {"id": 88, "question": "How can you switch the active log file?", "choices": ["Run fw logswitch on the Management Server", "Run fwm logswitch on the Management Server", "Run fw logswitch on the gateway", "Run fwm logswitch on the gateway"], "answer": 0}, {"id": 89, "question": "What destination versions are supported for a Multi-Version Cluster Upgrade?", "choices": ["R77.30 and later", "R80.10 and Later", "R70 and Later", "R76 and later"], "answer": 1}, {"id": 90, "question": "Which command can you use to verify the number of active concurrent connections?", "choices": ["fw conn all", "show all connections", "fw ctl pstat", "show connections"], "answer": 2}, {"id": 91, "question": "Under which file is the proxy arp configuration stored?", "choices": ["$FWDIR/state/_tmp/proxy.arp on the security gateway", "$FWDIR/conf/local.arp on the management server", "$FWDIR/conf/local.arp on the gateway", "$FWDIR/state/proxy_arp.conf on the management server"], "answer": 2}, {"id": 92, "question": "What are the correct steps upgrading a HA cluster (M1 is active, M2 is passive) using Multi-Version Cluster(MVC)Upgrade?", "choices": ["1) In SmartConsole, change the version of the cluster object\n2) Upgrade the passive node M2 to R81.20\n3) Enable the MVC mechanism on the upgraded R81.20 Cluster Member M2 in CLISH: set cluster member mvc on\n4) Install the Access Control Policy and make sure that the installation will not stop if installation on one cluster member fails\n5) After examine the cluster states upgrade node M1 to R81.20\n6) On each Cluster Member, disable the MVC mechanism and Install the Access Control Policy SmartConsole, change the version of the cluster object", "1) Enable the MVC mechanism on both cluster members #cphaprob mvc on\n2) Upgrade the passive node M2 to R81.20\n3) In SmartConsole, change the version of the cluster object\n4) Install the Access Control Policy\n5) After examine the cluster states upgrade node M1 to R81.20\n6) On each Cluster Member, disable the MVC mechanism and Install the Access Control Policy", "1) Enable the MVC mechanism on both cluster members in CLISH: set cluster member mvc on\n2) Upgrade the passive node M2 to R81.20\n3) In SmartConsole, change the version of the cluster object\n4) Install the Access Control Policy and make sure that the installation will not stop if installation on one cluster member fails\n5) After examine the cluster states upgrade node M1 to R81.20\n6) On each Cluster Member, disable the MVC mechanism", "1) Upgrade the passive node M2 to R81.20"], "answer": 0}, {"id": 93, "question": "You pushed a policy to your gateway, and you cannot access the gateway remotely anymore. What command should you use to remove the policy from the gateway by logging in through console access?", "choices": ["“fw unloadpolicy”", "“fw unloadlocal”", "“fw cpstop”", "“fw undo”"], "answer": 1}, {"id": 94, "question": "Which command would disable a Cluster Member permanently?", "choices": ["clusterXL_admin_down", "cphaprob_admin down", "clusterXL_admin down –p", "set clusterXL down –p"], "answer": 2}, {"id": 95, "question": "While using the Gaia CLI, what is the correct command to publish changes to the management server?", "choices": ["json publish", "mgmt publish", "mgmt_cli commit", "commit"], "answer": 1}, {"id": 96, "question": "The fwd process on the Security Gateway sends logs to the fwd process on the Management Server, where it is forwarded to ______ via ______.", "choices": ["cpm, cpd", "cpwd, fwssd", "fwm, cpd", "cpd, fwm"], "answer": 0}, {"id": 97, "question": "Which TCP port does the CPM process listen on?", "choices": ["19009", "18191", "8983", "18190"], "answer": 0}, {"id": 98, "question": "What command is used to manually failover a cluster during a zero-downtime upgrade?", "choices": ["clusterXL_admin down", "set cluster member down", "cpstop", "set clusterXL down"], "answer": 0}, {"id": 99, "question": "Which of the following is an identity acquisition method that allows a Security Gateway to identify Active Directory users and computers?", "choices": ["UserCheck", "User Directory Query", "Account Unit Query", "Active Directory Query"], "answer": 3}, {"id": 100, "question": "Fill in the blank: Browser-based Authentication sends users to a web page to acquire identities using _______.", "choices": ["UserCheck", "User Directory", "Captive Portal and Transparent Kerberos Authentication", "Captive Portal"], "answer": 3}, {"id": 101, "question": "Which User-mode process is responsible for the FW CLI commands?", "choices": ["cpm", "cpd", "fwm", "fwd"], "answer": 3}, {"id": 102, "question": "Aaron is a Cyber Security Engineer working for Global Law Firm with large scale deployment of Check Point Enterprise Appliances running GAiA R80.X. The Network Security Developer Team is having an issue testing the API with a newly deployed R80.X Security Management Server. Aaron wants to confirm API services are working properly. What should he do first?", "choices": ["Aaron should check API Server status with “api status\" from Expert mode. If services are stopped, he should start them with “api start\".", "Aaron should check API Server status with “cpapi status\" from Expert mode. If services are stopped, he should start them with \"cpapi start”.", "Aaron should check API Server status with “fwm api status” from Expert mode. If services are stopped, he should start them with “fwm api. start\".", "Aaron should check API Server status with \"cpm api status” from Expert mode. If services are stopped, he should start them with “cpi api. start\"."], "answer": 0}, {"id": 103, "question": "For Management High Availability, which of the following is NOT a valid synchronization status?", "choices": ["Collision", "Lagging", "Never been synchronized", "Down"], "answer": 3}, {"id": 104, "question": "If the Active Security Management Server falls or if it becomes necessary to change the Active to Standby, the following steps must be taken to prevent data loss. Providing the Active Security Management Server is responsive, which if these steps should NOT be performed:", "choices": ["Rename the hostname of the Standby member to match exactly the hostname of the Active member.", "Change the Active Security Management Server to Standby.", "Manually synchronize the Active and Standby Security Management Servers.", "Change the Standby Security Management Server to Active."], "answer": 0}, {"id": 105, "question": "What should the admin do in case the Primary Management Server is temporary down?", "choices": ["Run the ‘promote_util’ to activate the Secondary Management server.", "The Secondary will take over automatically. Change the IP in SmartConsole to logon to the private IP of the Secondary Management Server.", "Use the VIP in SmartConsole you always reach the active Management Server.", "Logon with SmartConsole to the Secondary Management Server and choose ‘Make Active’ under Actions in the HA Management Menu."], "answer": 3}, {"id": 106, "question": "Alice & Bob are going to use Management Data Plane Separation and therefore the routing separation needs to be enabled. Which of the following command is true for enabling the Management Data Plane Separation (MDPS):", "choices": ["set mdps split brain on", "set mdps data plane off", "set mdps mgmt plane on", "set mdps split plane on"], "answer": 2}, {"id": 107, "question": "Check Point Management (cpm) is the main management process in that it provides the architecture for a consolidated management console. It empowers the migration from legacy Client-side logic to Server-side logic. The cpm process", "choices": ["Performs database tasks such as creating, deleting, and modifying objects and compiling policy.", "Allows SmartConsole to communicate over TCP Port 19001", "Performs database tasks such as creating, deleting, and modifying objects and indexing logs", "Allows SmartConsole to communicate over TCP Port 18190"], "answer": 0}, {"id": 108, "question": "Which Check Point daemon invokes and monitors critical processes and attempts to restart them if they fail?", "choices": ["cpm", "cpwd", "fwm", "cpd"], "answer": 1}, {"id": 109, "question": "John is using Management HA. Which Security Management Server should he use for making changes?", "choices": ["Primary Log Server", "connect virtual IP of Smartcenter HA", "active SmartConsole", "secondary Smartcenter"], "answer": 2}, {"id": 110, "question": "What is the biggest benefit of policy layers?", "choices": ["To break one policy into several virtual policies.", "To include Threat Prevention as a sub policy for the firewall policy", "Policy Layers and Sub-Policies enable flexible control over the security policy", "They improve the performance on OS kernel version 3.0"], "answer": 2}, {"id": 111, "question": "What is “Accelerated Policy Installation”? Topic 1", "choices": ["Starting R81, the QoS Policy installation process is accelerated thereby reducing the duration of the process significantly", "Starting in R81, the Threat Prevention Policy installation process is accelerated thereby reducing the duration of the process significantly", "Starting R81, the Desktop Security Policy installation process is accelerated thereby reducing the duration of the process significantly", "Starting R81, the Access Control Policy installation process is accelerated thereby reducing the duration of the process significantly"], "answer": 3}, {"id": 112, "question": "Name the authentication method that requires token authenticator.", "choices": ["SecureID", "DynamicID", "Radius", "TACACS"], "answer": 0}, {"id": 113, "question": "Fill in the blank. With the User Directory Software Blade, you can create user definitions on a(n)_______ Server.", "choices": ["SecurID", "NT domain", "LDAP", "SMTP"], "answer": 2}, {"id": 114, "question": "Access roles allow the firewall administrator to configure network access according to:", "choices": ["a combination of computer or computer groups and networks.", "All of the above.", "remote access clients.", "users and user groups."], "answer": 1}, {"id": 115, "question": "Which of the following is NOT a type of Endpoint Identity Agent?", "choices": ["Custom", "Full", "Terminal", "Light"], "answer": 2}, {"id": 116, "question": "What object type would you use to grant network access to an LDAP user group?", "choices": ["Access Role", "Group Template", "SmartDirectory Group", "User Group"], "answer": 3}, {"id": 117, "question": "Which Identity Source(s) should be selected in Identity Awareness for when there is a requirement for a higher level of security for sensitive servers?", "choices": ["Endpoint Identity Agent and Browser-Based Authentication", "AD Query", "Terminal Servers Endpoint Identity Agent", "RADIUS and Account Logon"], "answer": 0}, {"id": 118, "question": "Which file contains the host address to be published, the MAC address that needs to be associated with the API address, and the unique IP of the interface that responds to ARP request?", "choices": ["/opt/CP-shrd-R80/conf/local.arp", "$FWDIR/conf/local.arp", "$CPDIR/conf/local.arp", "/var/opt/CPshrd-R80/conf/local.arp"], "answer": 1}, {"id": 119, "question": "Which command shows only the table names of all kernel tables?", "choices": ["fw tab –t", "fw tab –n", "fw tab –s", "fw tab –k"], "answer": 2}, {"id": 120, "question": "Which command lists all tables in Gaia?", "choices": ["fw tab –s", "fw tab –list", "fw tab –t", "fw tab –l"], "answer": 0}, {"id": 121, "question": "Which command is used to display status information for various components?", "choices": ["show sysenrv all", "show all systems", "show system messages", "sysmess all"], "answer": 0}, {"id": 122, "question": "Where is the license for Check Point Module users installed?", "choices": ["The Primary Gateway", "The Standby Gateway", "The Endpoint Server", "The Security Management Server"], "answer": 3}, {"id": 123, "question": "Secure Configuration Verification (SCV) makes sure that remote access client computers are configured in accordance with the enterprise Security Policy. Bob was asked by Alice to implement a specific SCV configuration but therefore Bob needs to edit and configure a specific Check Point file. Which location file and directory is true?", "choices": ["$CPDIR/conf/client.svc", "$FWDIR/conf/local.scv", "$CPDIR/conf/local.scv", "$FWDIR/conf/client.scv"], "answer": 1}, {"id": 124, "question": "There are multiple types of licenses for the various VPN components and types. License type related to management and functioning of Remote Access VPNs are – which of the following license requirement statement is NOT true: required to manage the suite", "choices": ["IPSecVPNLicense » This license is installed on the VPN Gateway and is a basic requirement for a Remote Access VPN solution", "EndpointPolicyManagementLicense » The Endpoint Security Suite includes blades other than the Remote Access VPN, hence this license is", "EndpointContainerLicense » The Endpoint Software Blade Licenses does not require an Endpoint Container License as the base", "MobileAccessLicense » This license is required on the Security Gateway for the following Remote Access solutions"], "answer": 2}, {"id": 125, "question": "You want to allow your Mobile Access Users to connect to an internal file share. Adding the Mobile Application ‘File Share’ to your Access Control Policy in the SmartConsole didn't work. You will be only allowed to select Services for the ‘Service & Application’ column. How to x it?", "choices": ["The Mobile Access Blade is not enabled under Gateway properties.", "The Mobile Access Blade is not enabled for the Access Control Layer of the policy.", "A Quantum Spark Appliance is selected as Installation Target for the policy packet.", "The Mobile Access Policy Source under Gateway properties is set to Legacy Policy and not to Unified Access Policy"], "answer": 1}, {"id": 126, "question": "Which of the following authentication methods ARE NOT used for Mobile Access?", "choices": ["SecurID", "TACACS+", "RADIUS server", "Username and password (internal, LDAP)"], "answer": 1}, {"id": 127, "question": "Which of the following type of authentication on Mobile Access can NOT be used as the first authentication method?", "choices": ["Username and Password", "Dynamic ID", "RADIUS", "Certificate"], "answer": 1}, {"id": 128, "question": "In what way are SSL VPN and IPSec VPN different?", "choices": ["IPSec VPN uses an additional virtual adapter, SSL VPN uses the client network adapter only.", "SSLVPN is using HTTPS in addition to IKE, whereas IPSec VPN is clientless", "IPSec VPN does not support two factor authentication, SSL VPN does support this", "SSLVPN adds an extra VPN header to the packet, IPSec VPN does not"], "answer": 0}, {"id": 129, "question": "Alice was asked by Bob to implement the Check Point Mobile Access VPN blade - therefore are some basic configuration steps required - which statement about the configuration steps is true?", "choices": ["1. Add a rule in the Access Control Policy and install policy\n2. Configure Mobile Access parameters in Security Gateway object\n3. Enable Mobile Access blade on the Security Gateway object and complete the wizard\n4. Connect to the Mobile Access Portal", "1. Connect to the Mobile Access Portal\n2. Enable Mobile Access blade on the Security Gateway object and complete the wizard\n3. Configure Mobile Access parameters in Security Gateway object\n4. Add a rule in the Access Control Policy and install policy", "1. Configure Mobile Access parameters in Security Gateway object\n2. Enable Mobile Access blade on the Security Gateway object and complete the wizard\n3 Add a rule in the Access Control Policy and install policy\n4. Connect to the Mobile Access Portal", "1. Enable Mobile Access blade on the Security Gateway object and complete the wizard"], "answer": 3}, {"id": 130, "question": "Which 3 types of tracking are available for Threat Prevention Policy?", "choices": ["None, Log, Syslog", "Alert, SNMP trap, Mail", "SMS Alert, Log, SNMP alert", "Syslog, None, User-defined scripts"], "answer": 1}, {"id": 131, "question": "Which SmartEvent component is responsible to collect the logs from different Log Servers?", "choices": ["SmartEvent Database", "SmartEvent Collector", "SmartEvent Correlation Unit", "SmartEvent Server"], "answer": 2}, {"id": 132, "question": "Please, choose the path to monitor the compliance status of the Check Point Security Management.", "choices": ["Logs Monitor –> New Tab –> Open compliance View", "Security Policies –> New Tab –> Compliance View", "Compliance blade not available under R80.10", "Gateways Servers –> Compliance View"], "answer": 0}, {"id": 133, "question": "You need to change the number of firewall instances used by CoreXL. How can you achieve this goal?", "choices": ["cpconfig; reboot not required", "edit fwaffinity.conf; reboot not required", "cpconfig; reboot required", "edit fwaffinity.conf; reboot required"], "answer": 2}, {"id": 134, "question": "Due to high CPU workload on the Security Gateway, the security administrator decided to purchase a new multicore CPU to replace the existing single core CPU. After installation, is the administrator required to perform any additional tasks?", "choices": ["Run cprestart from clish", "After upgrading the hardware, increase the number of kernel instances using cpconfig", "Administrator does not need to perform any task. Check Point will make use of the newly installed CPU and Cores", "Hyperthreading must be enabled in the bios to use CoreXL."], "answer": 1}, {"id": 135, "question": "Bob is asked by Alice to disable the SecureXL mechanism temporary for further diagnostic by their Check Point partner. Which of the following Check Point Command is true:", "choices": ["fwaccel templates", "fwaccel suspend", "fwaccel standby", "fwaccel off"], "answer": 3}, {"id": 136, "question": "If SecureXL is disabled which path is used to process traffic?", "choices": ["Passive path", "Firewall path", "Medium path", "Accelerated path"], "answer": 1}, {"id": 137, "question": "Which of the following Central Deployment is NOT a limitation in R81.20 SmartConsole?", "choices": ["Security Gateways/Clusters is ClusterXL HA new mode", "Dedicated Log Server", "Security Gateway Clusters in Load Sharing mode", "Dedicated SmartEvent Server"], "answer": 0}, {"id": 138, "question": "Matt wants to upgrade his old Security Management Server to R81.x using the Advanced Upgrade with Database Migration. What is one of the requirements for a successful upgrade?", "choices": ["Size of the /var/log folder of the source machine must be at least 25% of the size of the /var/log directory on the target machine", "Size of the $FWDIR/log folder of the target machine must be a least 25% of the size of the $FWDIR/log directory on the source machine", "Size of the /var/log folder of the target machine must be 25GB or more", "Size of the /var/log folder of the target machine must be at least 25% of the size of the /var/log directory on the source machine"], "answer": 3}, {"id": 139, "question": "Which of the following is true regarding the Proxy ARP feature for Manual NAT?", "choices": ["The local.arp file must always be configured", "Automatic proxy ARP configuration can be enabled", "fw ctl proxy should be configured", "Translate Destination on Client Side should be configured"], "answer": 0}, {"id": 140, "question": "What is the recommended number of physical network interfaces in a Mobile Access cluster deployment? fourth interface leading to the Security Management Server", "choices": ["2 Interfaces - a data interface leading to the organization and the Internet, a second interface for synchronization", "3 Interfaces - an interface leading to the organization, a second interface leading to the internet, a third interface for synchronization", "4 Interfaces - an interface leading to the organization, a second interface leading to the internet, a third interface for synchronization, a", "1 interface - an interface leading to the organization and the Internet, and configure for synchronization"], "answer": 1}, {"id": 141, "question": "Bob is going to prepare the import of the exported R81.10 management database. Now he wants to verify that the installed tools on the new target security management machine are able to handle the R81.10 release. Which of the following Check Point command is true?", "choices": ["$FWDIR/scripts/migrate_server print_installed_tools -v R77.30", "$CPDIR/scripts/migrate_server print_installed_tools -v R81.10", "$FWDIR/scripts/migrate_server print_uninstalled_tools -v R81.10", "$FWDIR/scripts/migrate_server print_installed_tools -v R81.10"], "answer": 3}, {"id": 142, "question": "The Firewall Administrator is required to create 100 new host objects with different IP addresses. What API command can he use in the script to achieve the requirement?", "choices": ["add hostname ip-address", "set hostname ip-address", "set host name ip-address", "mgmt_cli-m add host name ip-address"], "answer": 3}, {"id": 143, "question": "Which of the following is NOT an identity source used for Identity Awareness?", "choices": ["Remote Access", "UserCheck", "RADIUS", "AD Query"], "answer": 1}, {"id": 144, "question": "There are 4 ways to use the Management API for creating host object with the Management API. Which one is NOT correct?", "choices": ["Using cpconfig", "Using CLISH", "Using SmartConsole GUI console", "Using Web Services"], "answer": 0}, {"id": 145, "question": "What is a feature that enables VPN connections to successfully maintain a private and secure VPN session without employing Stateful Inspection?", "choices": ["VPN Routing Mode", "Stateless Mode", "Stateful Mode", "Wire Mode"], "answer": 3}, {"id": 146, "question": "The Check Point installation history feature in provides the following:", "choices": ["View install changes and install specific version.", "Policy Installation Date, view install changes and install specific version", "Policy Installation Date only", "View install changes"], "answer": 1}, {"id": 147, "question": "Bob has finished to setup provisioning a secondary security management server. Now he wants to check if the provisioning has been correct. Which of the following Check Point command can be used to check if the security management server has been installed as a primary or a secondary security management server?", "choices": ["cpprod_util MgmtIsPrimary", "cpprod_util FwIsSecondary", "cpprod_util FwIsPrimary", "cpprod_util MgmtIsSecondary"], "answer": 2}, {"id": 148, "question": "Connections to the Check Point R80 Web API use what protocol?", "choices": ["SIC", "SOAP", "HTTPS", "HTTP"], "answer": 2}, {"id": 149, "question": "How can you see historical data with cpview?", "choices": ["cpview -e", "cpview -d", "cpview -f", "cpview -t"], "answer": 3}, {"id": 150, "question": "The “fw monitor” tool can be best used to troubleshoot _________.", "choices": ["FWD issues", "Authentication issues", "Logging issues", "Network traffic issues"], "answer": 3}, {"id": 151, "question": "Alice & Bob are going to deploy Management Data Plane Separation (MDPS) for all their Check Point Security Gateway(s)/Cluster(s). Which of the following statement is true:", "choices": ["Data Plane - To access, provision and monitor the Security Gateway", "Management Plane - for all other network traffic and processing", "Each network environment is dependent and includes interfaces, routes, sockets, and processes", "Management Plane - To access, provision and monitor the Security Gateway"], "answer": 3}, {"id": 152, "question": "The customer has about 150 remote access user with Windows laptops. Not more than 50 Clients will be connected at the same time. The customer wants to use multiple VPN Gateways as entry point and a personal firewall. What will be the best license for him?", "choices": ["He will need Harmony Endpoint because of the personal firewall.", "Mobile Access license because he needs only a 50 user license, license count is per concurrent user.", "Because the customer uses only Windows clients SecuRemote will be sucient and no additional license is needed.", "He will need Capsule Connect using MEP (multiple entry points)."], "answer": 0}, {"id": 153, "question": "According to the policy installation flow the transfer state (CPTA) is responsible for the code generated by the FWM. On the Security Gateway side, a process receives them and first stores them into a temporary directory. Which process is true for receiving these files:", "choices": ["CPD", "RAD", "FWD", "FWM"], "answer": 0}, {"id": 154, "question": "What ports are used for SmartConsole to connect to the Security Management Server?", "choices": ["CPMI (18190)", "ICA_Pull (18210), CPMI (18190) https (443)", "CPM (19009), CPMI (18190) https (443)", "CPM (19009), CPMI (18190) CPD (18191)"], "answer": 2}, {"id": 155, "question": "Which of the following Check Point processes within the Security Management Server is responsible for the receiving of log records from Security Gateway?", "choices": ["cpd", "fwm", "logd", "fwd"], "answer": 3}, {"id": 156, "question": "Which packet info is masked with Session Rate Acceleration?", "choices": ["source ip", "source port ranges", "source port", "same info from Packet Acceleration is used"], "answer": 2}, {"id": 157, "question": "With SecureXL enabled, accelerated packets will pass through the following:", "choices": ["Network Interface Card, Check Point Firewall Kernel, and the Acceleration Device", "Network Interface Card, OSI Network Layer, OS IP Stack, and the Acceleration Device", "Network Interface Card, OSI Network Layer, and the Acceleration Device", "Network Interface Card and the Acceleration Device"], "answer": 3}, {"id": 158, "question": "In R81.10 a new feature called dynamic log distribution was added. What is this for? space in /var/log redundancy", "choices": ["Synchronize the log between the primary and secondary management server in case of a Management High Availability", "In case of a Management High Availability the management server stores the logs dynamically on the member with the most available disk", "To save disk space in case of a firewall cluster local logs are distributed between the cluster members", "Configure the Security Gateway to distribute logs between multiple active Log Servers to support a better rate of Logs and Log Servers"], "answer": 3}, {"id": 159, "question": "Check Point Management (cpm) is the main management process in that it provides the architecture for a consolidated management console. CPM allows the GUI client and management server to communicate via web services using _______.", "choices": ["TCP Port 18190", "TCP Port 18191", "TCP Port 18209", "TCP port 19009"], "answer": 3}, {"id": 160, "question": "CPM process stores objects, policies, users, administrators, licenses and management data in a database. This database is:", "choices": ["MySQL", "SOLR", "MarisDB", "PostgreSQL"], "answer": 3}, {"id": 161, "question": "What are scenarios supported by the Central Deployment in SmartConsole?", "choices": ["Installation of Jumbo Hotfix on a ClusterXL environment in High Availability Mode", "Upgrading a Dedicated SmartEvent Server", "Upgrading a Dedicated Log Server to R81", "Upgrading a Standalone environment"], "answer": 0}, {"id": 162, "question": "What solution is Multi-queue intended to provide?", "choices": ["Reduce the confusion for traffic capturing in FW Monitor", "Reduce the performance of network interfaces", "Improve the efficiency of CoreXL Kernel Instances", "Improve the efficiency of traffic handling by SecureXL SNDs"], "answer": 3}, {"id": 163, "question": "From SecureXL perspective, what are the three paths of traffic flow:", "choices": ["Initial Path; Medium Path; Accelerated Path", "Firewall Path; Accept Path; Drop Path", "Layer Path; Blade Path; Rule Path", "Firewall Path; Accelerated Path; Medium Path"], "answer": 3}, {"id": 164, "question": "What command is used to manually failover a Multi-Version Cluster during the upgrade?", "choices": ["set cluster member state down in Clish", "clusterXL_admin down in Expert Mode", "set cluster down in Expert Mode", "clusterXL_admin down in Clish"], "answer": 1}, {"id": 165, "question": "Fill in the blank: An identity server uses a ____________ to trust a Terminal Server Identity Agent.", "choices": ["Shared secret", "One-time password", "Certificate", "Token"], "answer": 0}, {"id": 166, "question": "How can you make sure that the old logs will be available after updating the Management to version R81.20 using the Advanced Upgrade Method?", "choices": ["Use the WebUI -> Maintenance > System Backup and store the backup on a remote FTP server", "The logs will be included running $FWDIR/scripts/migrate_server export -v R81.10", "Use the WebUI to save a snapshot before updating the Management -> Maintenance > Snapshot Management", "Use the migrate_server tool with the option ‘-l’ for the logs and ‘-x’ for the index"], "answer": 3}, {"id": 167, "question": "The Check Point Central Deployment Tool (CDT) communicates with the Security Gateway(s) over Check Point SIC via ___________.", "choices": ["TCP Port 19009", "TCP Port 18190", "TCP Port 18191", "TCP Port 18209"], "answer": 3}, {"id": 168, "question": "What is the command to check the status of Check Point processes?", "choices": ["cphaprob list", "top", "cpwd_admin list", "cptop"], "answer": 3}, {"id": 169, "question": "Which of the following processes pulls the application monitoring status from gateways?", "choices": ["cpm", "cpd", "fwm", "cpwd"], "answer": 1}, {"id": 170, "question": "What is false regarding a Management HA environment?", "choices": ["SmartConsole can connect to any management server in ReadOnly mode.", "It is not necessary to establish SIC between the primary and secondary management server, since the latter gets the exact same copy of the management database from the prior.", "Only one Management Server should be active, while any others be in standby mode", "Synchronization will occur automatically with each Publish event if the Standby servers are available."], "answer": 1}, {"id": 171, "question": "In CoreXL, the Firewall kernel is replicated multiple times. Each replicated copy or instance can perform the following:", "choices": ["The Firewall kernel only touches the packet if the connection is accelerated", "The Firewall kernel is replicated only with new connections and deletes itself once the connection times out", "The Firewall can run the same policy on all cores", "The Firewall can run different policies per core"], "answer": 2}, {"id": 172, "question": "An established connection is going to www.google.com. The Application Control Blade is inspecting the traffic. If SecureXL and CoreXL are both enabled, which path is handling the traffic?", "choices": ["Medium Path", "Accelerated Path", "Slow Path", "Fast Path"], "answer": 0}, {"id": 173, "question": "Which is the lowest gateway version supported by R81.20 management server?", "choices": ["R77.30", "R80.20", "R77", "R65"], "answer": 0}, {"id": 174, "question": "What is the purpose of Captive Portal?", "choices": ["It authenticates users, allowing them access to the Gaia OS", "It authenticates users, allowing them access to the Internet and corporate resources", "It provides remote access to SmartConsole", "It manages user permission in SmartConsole"], "answer": 1}, {"id": 175, "question": "Which of the following is NOT a component of Check Point Capsule?", "choices": ["Capsule Workspace", "Capsule Enterprise", "Capsule Docs", "Capsule Cloud"], "answer": 1}, {"id": 176, "question": "Which of the following is a task of the CPD process?", "choices": ["Transfers messages between Firewall processes", "Invoke and monitor critical processes and attempts to restart them if they fail", "Responsible for processing most traffic on a security gateway", "Log forwarding"], "answer": 0}, {"id": 177, "question": "To fully enable Dynamic Dispatcher on a Security Gateway:", "choices": ["Using cpconfig, update the Dynamic Dispatcher value to “full” under the CoreXL menu", "Edit /proc/interrupts to include multik set_mode 1 at the bottom of the file, save, and reboot", "run fw ctl multik set_mode 1 in Expert mode and then reboot", "run “fw ctl multik dynamic_dispatching on” and then reboot"], "answer": 3}, {"id": 178, "question": "You have successfully backed up your Management Server database without the OS information. What command would you use to restore this backup?", "choices": ["restore_backup", "import backup", "cp_merge", "migrate_server import"], "answer": 3}, {"id": 179, "question": "You have a Gateway that is running with 2 cores. You plan to add a second gateway to build a cluster and used a device with 4 cores. How many cores can be used in a Cluster for Firewall-kernel on the new device?", "choices": ["2", "1", "3", "4"], "answer": 0}, {"id": 180, "question": "Which of the SecureXL templates are enabled by default on Security Gateway?", "choices": ["NAT", "Drop", "None", "Accept"], "answer": 3}, {"id": 181, "question": "Which command shows the current connections distributed by CoreXL FW instances?", "choices": ["fw ctl iist", "fw ctl instances -v", "fw ctl multik stat", "fw ctl affinity -1"], "answer": 2}, {"id": 182, "question": "SecureXL improves non-encrypted firewall traffic throughput and encrypted VPN traffic throughput.", "choices": ["True, because SecureXL does improve all traffic", "True, because SecureXL does improve this traffic", "False, because encrypted traffic cannot be inspected", "False, because SecureXL does not improve this traffic but CoreXL does"], "answer": 1}, {"id": 183, "question": "The system administrator of a company is trying to find out why acceleration is not working for the traffic. The traffic is allowed according to the rule base and checked for viruses. But it is not accelerated. What is the most likely reason that the traffic is not accelerated?", "choices": ["The packets are not multicast", "The packet is the second in an established TCP connection", "The connection is destined for a server within the network", "The connection required a Security server"], "answer": 3}, {"id": 184, "question": "By default, the web API uses which content-type in its response?", "choices": ["JSON", "Java Script", "Text", "XML"], "answer": 0}, {"id": 185, "question": "Which command is used to set the CCP protocol to Multicast?", "choices": ["cphaprob set_ccp no_broadcast", "cphaconf set_ccp no_broadcast", "cphaprob set_ccp multicast", "cphaconf set_ccp multicast"], "answer": 3}, {"id": 186, "question": "An administrator wishes to enable Identity Awareness on the Check Point firewalls. However, they allow users to use company issued or personal laptops. Since the administrator cannot manage the personal laptops, which of the following methods would BEST suit this company?", "choices": ["AD Query", "Terminal Servers Agent", "Identity Agents", "Browser-Based Authentication"], "answer": 3}, {"id": 187, "question": "What is the amount of Priority Queues by default?", "choices": ["There are 8 priority queues by default, and up to 8 additional queues can be manually configured", "There are 7 priority queues by default and this number cannot be changed.", "There is no distinct number of queues since it will be changed in a regular basis based on its system requirements.", "There are 8 priority queues and this number cannot be changed."], "answer": 0}, {"id": 188, "question": "What is the SOLR database for?", "choices": ["Serves GUI responsible to transfer request to the DLEserver", "Used for full text search and enables powerful matching capabilities", "Enables powerful matching capabilities and writes data to the database", "Writes data to the database and full text search"], "answer": 1}, {"id": 189, "question": "Fill in the blank: An Endpoint Identity agent uses a _________ for user authentication.", "choices": ["Shared secret", "Username/password or Kerberos Ticket", "Token", "Certificate"], "answer": 1}, {"id": 190, "question": "Which of the following is an authentication method used for Identity Awareness?", "choices": ["RSA", "SSL", "Captive Portal", "PKI"], "answer": 2}, {"id": 191, "question": "Your manager asked you to check the status of SecureXL, and its enabled templates and features. What command will you use to provide such information to manager?", "choices": ["fwaccel stats", "fwaccel stat", "fw access stats", "fw accel stat"], "answer": 1}, {"id": 192, "question": "What command lists all interfaces using Multi-Queue?", "choices": ["show interface all", "mq_mng –show", "show multiqueue all", "cpmq set"], "answer": 1}, {"id": 193, "question": "What is true about the IPS-Blade?", "choices": ["In the IPS Layer, the only three possible actions are Basic, Optimized and Strict", "IPS is managed by the Threat Prevention Policy", "IPS Exceptions cannot be attached to “all rules”", "The GeoPolicy Exceptions and the Threat Prevention Exceptions are the same"], "answer": 1}, {"id": 194, "question": "Alice wants to upgrade the current security management machine from R80.40 to R81.20 and she wants to check the Deployment Agent status over the GAIA CLISH. Which of the following GAIA CLISH command is true?", "choices": ["show installer packages", "show agent status", "show uninstaller status", "show installer status"], "answer": 3}, {"id": 195, "question": "Which member of a high-availability cluster should be upgraded first in a Zero downtime upgrade?", "choices": ["The Primary Member", "The Standby Member", "The Secondary Member", "The Active Member"], "answer": 1}, {"id": 196, "question": "Which type of Endpoint Identity Agent includes packet tagging and computer authentication?", "choices": ["Full", "Custom", "Light", "Complete"], "answer": 0}, {"id": 197, "question": "Which Check Point software blade provides visibility of users, groups and machines while also providing access control through identity-based policies?", "choices": ["Application Control", "Firewall", "Identity Awareness", "URL Filtering"], "answer": 2}, {"id": 198, "question": "Which of the following is NOT an attribute of packet acceleration?", "choices": ["Destination port", "Protocol", "VLAN tag", "Source address"], "answer": 2}, {"id": 199, "question": "When using the Mail Transfer Agent, where are the debug logs stored?", "choices": ["$FWDIR/log/mtad.elg", "$CPDIR/log/emailed.elg", "$FWDIR/bin/email.mta.elg", "/var/log/mail.mta.elg"], "answer": 0}];

const el = (sel)=>document.querySelector(sel);
const quizEl = el('#quiz');
const scoreBanner = el('#scoreBanner');
const modeEl = el('#mode');
const countEl = el('#count');
const toggleReviewBtn = el('#toggleReviewBtn');
const confirmBtn = el('#confirmBtn');
const nextBtn = el('#nextBtn');
const prevBtn = el('#prevBtn');
const footerCard = el('#footerCard');
const rangeFromEl = el('#rangeFrom');
const rangeToEl = el('#rangeTo');
const searchWrap = el('#searchWrap');
const searchInput = el('#searchInput');
const searchBtn = el('#searchBtn');
const clearSearchBtn = el('#clearSearchBtn');
const countWrap = el('#countWrap');
const rangeWrap = el('#rangeWrap');
const toggleOriginal = el('#toggleOriginal');

let started = false;
let order = [];
let answers = {};
let revealed = {};
let locked = {};
let idx = 0;

const OLD_WRONG_KEY = "ccse_wrong_ids";
const OLD_MARK_KEY  = "ccse_mark_ids";
const REVIEW_KEY    = "ccse_review_ids";
const STATS_KEY     = "ccse_stats";
const SHOW_ORIG_KEY = "ccse_show_orig";
(function migrate(){
  try {
    const existing = JSON.parse(localStorage.getItem(REVIEW_KEY) || "[]");
    if (!existing || existing.length === 0){
      const oldWrong = JSON.parse(localStorage.getItem(OLD_WRONG_KEY) || "[]");
      const oldMark  = JSON.parse(localStorage.getItem(OLD_MARK_KEY)  || "[]");
      const merged = Array.from(new Set([...(oldWrong||[]), ...(oldMark||[])]));
      if (merged.length){
        localStorage.setItem(REVIEW_KEY, JSON.stringify(merged));
      }
    }
  } catch(e){}
})();
const reviewSet = new Set(JSON.parse(localStorage.getItem(REVIEW_KEY) || "[]"));
let stats = {};
try { stats = JSON.parse(localStorage.getItem(STATS_KEY) || "{}"); } catch(e){ stats = {}; }
try { toggleOriginal.checked = JSON.parse(localStorage.getItem(SHOW_ORIG_KEY) || "false"); } catch(e){}

function updateHdr(){
  el('#hdrMeta').textContent = `題庫：${BANK.length} 題｜複習清單：${reviewSet.size}`;
  const mode = modeEl.value;
  footerCard.classList.toggle('hidden', !started || mode==='review_list_all' || mode==='search');
  countWrap.classList.toggle('hidden', !(mode==='exam' || mode==='review_list'));
  rangeWrap.classList.toggle('hidden', !(mode==='exam' || mode==='review_list'));
  searchWrap.classList.toggle('hidden', mode!=='search');
  scoreBanner.classList.add('hidden');
}

function persist(){
  localStorage.setItem(REVIEW_KEY, JSON.stringify(Array.from(reviewSet)));
  localStorage.setItem(STATS_KEY, JSON.stringify(stats));
  localStorage.setItem(SHOW_ORIG_KEY, JSON.stringify(toggleOriginal.checked));
  updateHdr();
}

function applyRange(pool){
  const fromV = parseInt(rangeFromEl.value||"");
  const toV = parseInt(rangeToEl.value||"");
  if(!isNaN(fromV) && !isNaN(toV)){
    const lo = Math.min(fromV, toV);
    const hi = Math.max(fromV, toV);
    return pool.filter(q => (q.id||0) >= lo && (q.id||0) <= hi);
  }
  return pool;
}

function buildQStats(qid){
  const s = stats[qid] || {attempts:0, correct:0, wrong:0};
  return `<span class="qstats">【作答次數: ${s.attempts}｜答對: ${s.correct}｜答錯: ${s.wrong}】</span>`;
}

function cleanQuestion(text){
  const re = /^\s*(question\s*#?\s*\d+\s*[:.)-]?\s*)/i;
  return text.replace(re, '');
}

function computeBasePool(){
  let base = [];
  if (modeEl.value === 'review_list' || modeEl.value === 'review_list_all') {
    base = BANK.filter(q=>reviewSet.has(q.id));
  } else {
    base = BANK.slice();
  }
  if (modeEl.value !== 'review_list_all' && modeEl.value !== 'search') base = applyRange(base);
  return base;
}

function showPreStartSummary(){
  const mode = modeEl.value;
  const n = parseInt(countEl.value,10);
  const base = computeBasePool();
  const poolSize = base.length;
  const fromV = rangeFromEl.value ? parseInt(rangeFromEl.value) : null;
  const toV = rangeToEl.value ? parseInt(rangeToEl.value) : null;
  const rangeTxt = (fromV && toV) ? `${Math.min(fromV,toV)}–${Math.max(fromV,toV)}` : '全部';
  const willUse = (mode==='exam' || mode==='review_list') ? Math.min(n, poolSize) : poolSize;

  const modeLabel = {exam:'Exam（考試模式）', review_list:'Review List（隨機）', review_list_all:'Review List（全部）', search:'Search'}[mode];

  const lines = [
    `<div>模式：<b>${modeLabel}</b></div>`,
    (mode==='search') ? `<div>說明：本模式需輸入關鍵字後按「搜尋」。</div>` : '',
    (mode!=='search' && mode!=='review_list_all') ? `<div>題號範圍：<b>${rangeTxt}</b></div>` : '',
    `<div>可用題數：<b>${poolSize}</b></div>`,
    (mode==='exam' || mode==='review_list') ? `<div>本次題數：<b>${willUse}</b></div>` : '',
  ].join('');

  quizEl.innerHTML = `
    <div class="card">
      <div class="summary">
        <div style="font-weight:600;">開始前摘要</div>
        ${lines}
        <div style="margin-top:8px; display:flex; gap:8px;">
          <button class="btn" id="confirmStartBtn">確認開始</button>
          <button class="btn secondary" id="cancelStartBtn">取消</button>
        </div>
      </div>
    </div>`;

  el('#confirmStartBtn').addEventListener('click', ()=>{
    started = true;
    startActual();
  });
  el('#cancelStartBtn').addEventListener('click', ()=>{
    started = false;
    render();
  });
}

function start(){ started = false; showPreStartSummary(); }

function startActual(){
  answers = {}; revealed = {}; locked = {}; idx = 0;
  scoreBanner.classList.add('hidden');

  const base = computeBasePool();

  if (modeEl.value === 'review_list_all' || modeEl.value === 'search') {
    order = base.slice().sort((a,b)=> (a.id||0)-(b.id||0));
    started = true;
    render();
  } else {
    const n = parseInt(countEl.value,10);
    order = base.slice();
    order = order.sort(()=>Math.random()-0.5).slice(0, Math.min(n, order.length)).map(q => ({...q}));
    if (modeEl.value === 'exam'){
      order = order.map(q => {
        const idxs = [0,1,2,3];
        idxs.sort(()=>Math.random()-0.5);
        const newChoices = idxs.map(i => q.choices[i]);
        const newAnswer = idxs.indexOf(q.answer);
        return {...q, choices:newChoices, answer:newAnswer};
      });
    }
    started = true;
    render();
  }
}

function onPick(i, choice){
  if (!started) return;
  if (locked[i]) return;
  answers[i] = choice;
  render();
}

function confirmCurrent(){
  if (!started) return;
  const q = order[idx];
  if (!q) return;
  if (revealed[idx]) return;
  const a = answers[idx];
  if (a === undefined) return;
  revealed[idx] = true;
  locked[idx] = true;
  if (!stats[q.id]) stats[q.id] = {attempts:0, correct:0, wrong:0};
  stats[q.id].attempts += 1;
  const outcome = (a === q.answer) ? 'correct' : 'wrong';
  stats[q.id][outcome] += 1;
  if (outcome === 'wrong') reviewSet.add(q.id);
  persist();
  render();
}

function goNext(){ if (started && revealed[idx] && idx < order.length - 1){ idx += 1; render(); } }
function goPrev(){ if (started && idx > 0){ idx -= 1; render(); } }

function render(){
  const mode = modeEl.value;
  updateHdr();
  if (!started){
    quizEl.innerHTML = `<div class="card"><div class="qtxt">按「開始」後會先顯示本次小測驗摘要。</div></div>`;
    return;
  }
  if (mode === 'review_list_all'){
    if(order.length===0){
      quizEl.innerHTML = `<div class="card"><div class="qtxt">目前「複習清單」是空的。</div></div>`;
      return;
    }
    quizEl.innerHTML = order.map((q,i)=> renderListCard(q, i, order.length)).join("");
    wireListControls();
    return;
  }
  if (mode === 'search'){
    const query = searchInput.value.trim();
    if(!query){
      quizEl.innerHTML = `<div class="card"><div class="qtxt">請輸入關鍵字再按「搜尋」。支援多關鍵字（以空白分隔）。</div></div>`;
      return;
    }
    const toks = query.split(/\s+/).map(s=>s.toLowerCase());
    const matches = order.filter(q=> toks.every(t=> (q.question+" "+q.choices.join(" ")).toLowerCase().includes(t)));
    if (matches.length===0){
      quizEl.innerHTML = `<div class="card"><div class="qtxt">沒有符合的題目。</div></div>`;
      return;
    }
    quizEl.innerHTML = matches.map((q,i)=> renderListCard(q, i, matches.length)).join("");
    wireListControls();
    return;
  }
  const q = order[idx];
  if(!q){
    quizEl.innerHTML = `<div class="card"><div class="qtxt">沒有符合條件的題目。請調整題號範圍或切換模式。</div></div>`;
    return;
  }
  const a = answers[idx];
  const isRevealed = !!revealed[idx];
  const isLocked = !!locked[idx];
  const choiceHTML = q.choices.map((c,k)=>{
    const chosen = (a === k);
    let cls = "choice";
    if (isLocked) cls += " locked";
    if (chosen) cls += " selected";
    if (isRevealed){
      if (k === q.answer) cls += " correct";
      if (chosen && k !== q.answer) cls += " wrong";
    }
    return `<div class="${cls}" data-k="${k}"><b>${(k+1)}</b>. ${c.replace(/</g,"&lt;")}</div>`;
  }).join("");
  const origIdHtml = toggleOriginal.checked ? `<div class="pill">原始ID #${q.id}</div>` : "";
  const cleaned = cleanQuestion(q.question).replace(/</g,"&lt;");
  quizEl.innerHTML = `
    <div class="card">
      <div class="qhead">
        <div class="qid">題目 ${idx+1} / ${order.length}</div>
        ${origIdHtml}
      </div>
      <div class="qstats">${buildQStats(q.id)}</div>
      <div class="qtxt">${cleaned}</div>
      <div class="choices">${choiceHTML}</div>
    </div>`;
  quizEl.querySelectorAll('.choice').forEach(ch=>{
    ch.addEventListener('click', ()=>{
      const k = parseInt(ch.dataset.k);
      onPick(idx, k);
    });
  });
  prevBtn.classList.toggle('disabled', idx===0);
  nextBtn.classList.toggle('disabled', idx===order.length-1 || !isRevealed);
  confirmBtn.classList.toggle('disabled', isRevealed || a===undefined);
  const inReview = reviewSet.has(q.id);
  toggleReviewBtn.classList.toggle('active', inReview);
  toggleReviewBtn.textContent = inReview ? '已在複習清單（5）' : '加入/移出複習清單（5）';
  try{ confirmBtn.blur(); nextBtn.blur(); prevBtn.blur(); toggleReviewBtn.blur(); }catch(e){}
}

function renderListCard(q, i, total){
  const s = stats[q.id] || {attempts:0, correct:0, wrong:0};
  const choices = q.choices.map((c,k)=>{
    const isCorrect = (k===q.answer);
    const cls = "choice" + (isCorrect ? " correct":"");
    return `<div class="${cls}"><b>${(k+1)}</b>. ${c.replace(/</g,"&lt;")}</div>`;
  }).join("");
  const origIdHtml = toggleOriginal.checked ? `<div class="pill">原始ID #${q.id}</div>` : "";
  const cleaned = cleanQuestion(q.question).replace(/</g,"&lt;");
  return `
  <div class="card" data-qid="${q.id}">
    <div class="qhead">
      <div class="qid">題目 ${i+1} / ${total}</div>
      ${origIdHtml}
    </div>
    <div class="qstats">【作答次數: ${s.attempts}｜答對: ${s.correct}｜答錯: ${s.wrong}】</div>
    <div class="qtxt">${cleaned}</div>
    <div class="choices">${choices}</div>
    <div class="inline-controls" style="margin-top:10px;">
      <button class="btn danger" data-action="removeReview">移出複習清單</button>
    </div>
  </div>`;
}

function wireListControls(){
  quizEl.querySelectorAll('.card').forEach(card=>{
    const qid = parseInt(card.dataset.qid,10);
    const removeBtn = card.querySelector('[data-action="removeReview"]');
    if(removeBtn){
      removeBtn.addEventListener('click', ()=>{
        reviewSet.delete(qid);
        persist();
        card.remove();
      });
    }
  });
}

function submit(){
  if (!started) return;
  const total = order.length;
  let correct = 0;
  const results = [];
  order.forEach((q,i)=>{
    const a = answers[i];
    const ok = (a === q.answer);
    if (ok) correct += 1;
    if (!ok) reviewSet.add(q.id);
    results.push({q, a, ok});
  });
  persist();
  scoreBanner.textContent = `本次成績：${correct}/${total}（${(correct/total*100).toFixed(1)}%）`;
  scoreBanner.classList.remove('hidden');

  quizEl.innerHTML = results.map(({q,a,ok},i)=>{
    const s = stats[q.id] || {attempts:0, correct:0, wrong:0};
    const choices = q.choices.map((c,k)=>{
      const isCorrect = (k===q.answer);
      const chosen = (a === k);
      let cls = "choice";
      if (isCorrect) cls += " correct";
      if (chosen && !isCorrect) cls += " wrong";
      if (chosen) cls += " selected";
      return `<div class="${cls}"><b>${(k+1)}</b>. ${c.replace(/</g,"&lt;")}</div>`;
    }).join("");
    const origIdHtml = toggleOriginal.checked ? `<div class="pill">原始ID #${q.id}</div>` : "";
    const cleaned = cleanQuestion(q.question).replace(/</g,"&lt;");
    const showRemove = (!ok) || reviewSet.has(q.id);
    const controls = showRemove ? `<div class="inline-controls" style="margin-top:10px;">
        <button class="btn danger" data-action="removeReview" data-qid="${q.id}">移出複習清單</button>
      </div>` : "";
    return `
    <div class="card" data-qid="${q.id}">
      <div class="qhead">
        <div class="qid">題目 ${i+1} / ${order.length}</div>
        ${origIdHtml}
      </div>
      <div class="qstats">【作答次數: ${s.attempts}｜答對: ${s.correct}｜答錯: ${s.wrong}】</div>
      <div class="qtxt">${cleaned}</div>
      <div class="choices">${choices}</div>
      ${controls}
    </div>`;
  }).join("");

  quizEl.querySelectorAll('[data-action="removeReview"]').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const qid = parseInt(btn.getAttribute('data-qid'),10);
      reviewSet.delete(qid);
      persist();
      btn.closest('.card')?.remove();
    });
  });
}

function toggleReviewForCurrent(){
  const q = order[idx];
  if(!q) return;
  if (reviewSet.has(q.id)) reviewSet.delete(q.id);
  else reviewSet.add(q.id);
  persist();
  render();
}
toggleReviewBtn.addEventListener('click', (e)=>{ toggleReviewForCurrent(); try{e.currentTarget.blur();}catch(err){} });

document.addEventListener('keydown', (e)=>{
  const t = e.target;
  const tag = (t && t.tagName) ? t.tagName.toLowerCase() : '';
  const isTyping = (tag==='input' || tag==='textarea' || tag==='select' || (t && t.isContentEditable));
  if (isTyping) return;

  if (!started) return;
  const mode = modeEl.value;
  if (mode==='exam' || mode==='review_list'){
    if (['1','2','3','4'].includes(e.key)){
      e.preventDefault(); e.stopPropagation();
      onPick(idx, parseInt(e.key)-1);
    } else if (e.key === '5' && mode==='exam'){
      e.preventDefault(); e.stopPropagation();
      toggleReviewForCurrent();
    } else if (e.key === 'Enter'){
      e.preventDefault(); e.stopPropagation();
      confirmCurrent();
    } else if (e.key === 'ArrowRight'){
      e.preventDefault(); e.stopPropagation();
      goNext();
    } else if (e.key === 'ArrowLeft'){
      e.preventDefault(); e.stopPropagation();
      goPrev();
    }
  }
});

el('#startBtn').addEventListener('click', ()=>{ started=false; showPreStartSummary(); });
el('#resetBtn').addEventListener('click', ()=>{
  answers = {}; revealed = {}; locked = {}; idx = 0; started = false;
  reviewSet.clear();
  stats = {};
  localStorage.removeItem(REVIEW_KEY);
  localStorage.removeItem(STATS_KEY);
  persist();
  render();
});
prevBtn.addEventListener('click', goPrev);
nextBtn.addEventListener('click', goNext);
confirmBtn.addEventListener('click', confirmCurrent);
el('#submitBtn').addEventListener('click', submit);
el('#exportReviewBtn').addEventListener('click', ()=>{
  const ids = Array.from(reviewSet);
  const blob = new Blob([JSON.stringify(ids, null, 2)], {type:"application/json"});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'ccse_review_ids.json';
  a.click();
});

modeEl.addEventListener('change', ()=>{
  answers = {}; revealed = {}; locked = {}; idx = 0;
  order = [];
  scoreBanner.classList.add('hidden');
  const mode = modeEl.value;
  if (mode === 'review_list_all') {
    started = true;
    const base = BANK.filter(q=>new Set(JSON.parse(localStorage.getItem('ccse_review_ids')||'[]')).has(q.id));
    order = base.slice().sort((a,b)=> (a.id||0)-(b.id||0));
    render();
  } else {
    started = false;
    render();
  }
});

toggleOriginal.addEventListener('change', ()=>{ persist(); render(); });
searchBtn.addEventListener('click', ()=>{
  if (!started){ started=true; startActual(); }
  order = BANK.slice().sort((a,b)=> (a.id||0)-(b.id||0));
  render();
});
clearSearchBtn.addEventListener('click', ()=>{
  searchInput.value = "";
  render();
});

updateHdr();
render();
</script>
</body>
</html>
